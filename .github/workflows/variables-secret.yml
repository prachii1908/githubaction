name: Exploring variables and secrets
on: push
##variable can be defined at workflow level, job level and step level. Here we are defining at workflow level
env:
  CONTAINER_REGISTRY: docker.io
  DOCKER_USERNAME: prachi1908
  IMAGE_NAME: github-actions-nginx
jobs:
    docker:
        runs-on: ubuntu-latest
        steps:
        - name: Docker build
          run: echo docker build -t $ {{ env.CONTAINER_REGISTRY }}/$DOCKER_USERNAME/$IMAGE_NAME:latest

        - name: Docker login
          env:
            DOCKER_PASSWORD: Prachi@123
          run: echo docker login --username $DOCKER_USERNAME --password $DOCKER_PASSWORD

        - name: Docker publish
          run: echo docker push $ {{ env.CONTAINER_REGISTRY }}/$DOCKER_USERNAME/$IMAGE_NAME:latest
    
    deploy:
        needs: docker
        runs-on: ubuntu-latest
        steps:
        - name: Docker run
          run: echo docker run -d -p 8080:80 $ {{ env.CONTAINER_REGISTRY }}/$DOCKER_USERNAME/$IMAGE_NAME:latest